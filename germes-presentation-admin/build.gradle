/*
 * This file was generated by the Gradle 'init' task.
 */
plugins {
    id 'war'
    id "org.gretty"
    id "io.franzbecker.gradle-lombok"
}

repositories {
    maven { url "http://repository.primefaces.org" }
}

dependencies {
    implementation project(":germes-common"), project(":germes-user-service"), project(":germes-common-monitoring"),
            project(":germes-geography-service-client"), project(":germes-user-service-client")

    implementation ui.primefaces, ui.jsf, ui.bootstrap, misc.jakartaInject, server.weldServlet, security.shiroCore,
            security.shiroWeb, metrics.dropwizardServlets, metrics.dropwizardGraphite
    providedCompile server.servletApi
    runtimeOnly persistence.mysql, persistence.hikariCp, misc.jaxbRuntime, log.commonsLogging
    compileOnly persistence.jpaApi

    testImplementation tests.junitVintage, server.weldSe, tests.cdiUnit
    testCompileOnly persistence.jpaApi
}

processResources {
    doFirst {
        ant.native2ascii(
                src   : project.file('src/main/resources/txt'),
                dest  : project.file('src/main/resources/ui'),
                ext : '.properties'
        )
    }
    exclude('txt', 'docker')
}

war {
    archiveName 'admin.war'
    classpath = classpath.filter {!project.hasProperty('payara') || !it.name.contains('weld')}
    classpath = classpath.filter {!project.hasProperty('wildfly') || !isWildFlyDependency(it)}
    classpath = classpath.filter {!it.name.contains('jmh-')}
}