/*
 * This file was generated by the Gradle 'init' task.
 */
plugins {
    id 'war'
    id "org.gretty"
    id "io.franzbecker.gradle-lombok"
}

repositories {
    maven { url "http://repository.primefaces.org" }
}

dependencies {
    implementation project(":germes-application-service"), project(":germes-application-model")
    implementation ui.primefaces, ui.jsf, ui.bootstrap, misc.jakartaInject, server.weldServlet, security.shiroCore, security.shiroWeb
    providedCompile server.servletApi
    runtimeOnly persistence.mysql, misc.jaxbRuntime, log.commonsLogging
    compileOnly persistence.jpaApi

    testImplementation tests.junitApi, tests.junitVintage, tests.hamcrest, tests.mockito, server.weldSe, tests.cdiUnit
    testCompileOnly tests.junitParams, persistence.jpaApi
    testRuntimeOnly tests.junitEngine, persistence.h2
}


// use appRunWar/appStartWar, appRun/appStart doesn't work well with Weld container
gretty {
    servletContainer = 'jetty9.4'
    contextPath = '/'
    httpPort = 9091
}

processResources {
    doFirst {
        ant.native2ascii(
                src   : project.file('src/main/resources/txt'),
                dest  : project.file('src/main/resources/ui'),
                ext : '.properties'
        )
    }
    exclude('txt', 'docker')
}

war {
    archiveName 'admin.war'
    classpath = classpath.filter {!project.hasProperty('payara') || !it.name.contains('weld')}
    classpath = classpath.filter {!project.hasProperty('wildfly') || !isWildFlyDependency(it)}
}